(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{30347:()=>{},34423:(e,a,r)=>{Promise.resolve().then(r.bind(r,72533)),Promise.resolve().then(r.bind(r,56068)),Promise.resolve().then(r.t.bind(r,30347,23)),Promise.resolve().then(r.bind(r,12231))},56068:(e,a,r)=>{"use strict";r.d(a,{A:()=>c,AuthProvider:()=>d});var s=r(95155),t=r(12115),i=r(34029),l=r(41519),n=r(82352);let o=(0,t.createContext)(),c=()=>(0,t.useContext)(o);function d(e){let{children:a}=e,[r,c]=(0,t.useState)(null),[d,m]=(0,t.useState)(null),[x,u]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{let e=(0,i.hg)(n.j,async e=>{if(c(e),e)try{let a=(0,l.H9)(n.db,"usuarios",e.uid),r=await (0,l.x7)(a);m(r.exists()?{id:r.id,...r.data()}:null)}catch(e){console.error("Error al obtener datos del usuario:",e),m(null)}else m(null);u(!1)});return()=>e()},[]),(0,s.jsx)(o.Provider,{value:{user:r,userData:d,loading:x},children:a})}},72533:(e,a,r)=>{"use strict";r.d(a,{default:()=>et});var s=r(95155),t=r(35695),i=r(11518),l=r.n(i),n=r(12115),o=r(34029),c=r(82352),d=r(56068),m=r(6874),x=r.n(m),u=r(66766),h=r(66474),f=r(57340),b=r(73783),g=r(29799),p=r(47881),j=r(48136),y=r(39191),v=r(23227),k=r(50675),A=r(50142),I=r(25273),w=r(26645),N=r(55868),z=r(93306),G=r(40646),T=r(39022),S=r(20699),E=r(95880),C=r(37108),q=r(27809),P=r(26027),H=r(93463),R=r(79249),D=r(97261),_=r(12318),M=r(86740),L=r(13836),O=r(42337),V=r(48313),Q=r(381),Y=r(54416),J=r(74783),U=r(60760),W=r(76408),B=r(41519),K=r(23861),Z=r(30832),F=r.n(Z);function X(){let[e,a]=(0,n.useState)([]),[r,t]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=F()().startOf("day").toDate(),r=(0,B.P)((0,B.rJ)(c.db,"notificaciones"),(0,B._M)("fecha",">=",e),(0,B.My)("fecha","desc")),s=(0,B.aQ)(r,e=>{a(e.docs.map(e=>({id:e.id,...e.data()})))});return()=>s()},[]);let i=async()=>{t(!r),r||e.filter(e=>!e.leida).forEach(async e=>{await (0,B.mZ)((0,B.H9)(c.db,"notificaciones",e.id),{leida:!0})})},l=e=>{switch(e){case"Liquidaci\xf3n":return"border-blue-500";case"Despacho":return"border-green-500";case"Devoluci\xf3n":return"border-yellow-500";default:return"border-gray-400"}};return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{onClick:i,className:"relative",children:[(0,s.jsx)(K.A,{className:"w-6 h-6 text-gray-700 dark:text-gray-300 hover:text-[#ff6413]"}),e.some(e=>!e.leida)&&(0,s.jsx)("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full px-2",children:e.filter(e=>!e.leida).length})]}),r&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-96 bg-white dark:bg-[#1c1c1e] shadow-lg rounded border z-50 max-h-96 overflow-auto",children:[(0,s.jsx)("div",{className:"p-3 font-bold border-b text-gray-700 dark:text-gray-200",children:"Notificaciones de Hoy"}),0===e.length?(0,s.jsx)("p",{className:"p-4 text-sm text-gray-500",children:"No hay notificaciones recientes."}):e.map(e=>{var a;return(0,s.jsxs)("div",{className:"p-3 border-l-4 ".concat(l(e.tipo)," mb-1"),children:[(0,s.jsx)("p",{className:"text-sm",children:e.mensaje}),e.link&&(0,s.jsx)("a",{href:e.link,target:"_blank",className:"text-blue-600 text-xs",children:"\uD83D\uDCC4 Ver Comprobante"}),(0,s.jsx)("div",{className:"text-gray-400 text-xs mt-1",children:F()(null==(a=e.fecha)?void 0:a.toDate()).format("DD/MM/YYYY HH:mm")})]},e.id)})]})]})}function $(){let[e,a]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=(0,B.P)((0,B.rJ)(c.db,"notificaciones"),(0,B.My)("fecha","desc"),(0,B.AB)(1)),r=(0,B.aQ)(e,e=>{e.docChanges().forEach(e=>{if("added"===e.type){let r=e.doc.data();a({id:e.doc.id,...r}),setTimeout(()=>{a(null)},5e3)}})});return()=>r()},[]),(0,s.jsx)(U.N,{children:e&&(0,s.jsxs)(W.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fixed top-4 right-4 bg-white dark:bg-gray-800 shadow-lg dark:shadow-2xl border-l-4 border-blue-500 dark:border-blue-400 p-4 rounded w-80 z-50",children:[(0,s.jsx)("h4",{className:"font-bold text-blue-600 dark:text-blue-300 mb-1",children:e.tipo}),(0,s.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.mensaje}),e.link&&(0,s.jsx)("a",{href:e.link,target:"_blank",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-xs underline mt-2 inline-block",children:"Ver Comprobante"})]})})}function ee(e){let{item:a,open:r,currentPathname:t,activeGroup:i,setActiveGroup:l}=e,o=a.subItems&&a.subItems.some(e=>t===e.href),c=t===a.href||o,d=!!a.subItems&&i===a.id;return((0,n.useEffect)(()=>{o&&i!==a.id&&l(a.id)},[o,a.id,l,t]),a.subItems&&a.subItems.length>0)?(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("button",{onClick:()=>l(d?null:a.id),className:"group relative flex items-center justify-between w-full gap-3 px-3 py-2.5 rounded-md text-sm transition-all duration-200 hover:bg-gray-100 dark:hover:bg-gray-700 ".concat(c?"text-[#ff6413] font-semibold bg-orange-50 dark:bg-gray-700":"text-gray-700 dark:text-gray-300"),"aria-expanded":d,"aria-controls":"submenu-".concat(a.id),children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-lg flex-shrink-0 w-5 h-5",children:a.icon}),r&&(0,s.jsx)("span",{className:"truncate",children:a.label})]}),r&&(0,s.jsx)("span",{className:"transform transition-transform duration-200 ".concat(d?"rotate-180":"rotate-0"),children:(0,s.jsx)(h.A,{size:16})})]}),(0,s.jsx)(U.N,{children:r&&d&&(0,s.jsx)(W.P.div,{id:"submenu-".concat(a.id),initial:{height:0,opacity:0,marginTop:0},animate:{height:"auto",opacity:1,marginTop:"0.25rem"},exit:{height:0,opacity:0,marginTop:0},transition:{duration:.2,ease:"easeInOut"},className:"ml-3 mt-1 pl-3 border-l border-gray-200 dark:border-gray-600 flex flex-col space-y-0.5",children:a.subItems.map(e=>(0,s.jsx)(ea,{href:e.href,icon:e.icon,label:e.label,open:r,isSubItem:!0},e.href))})})]}):null}function ea(e){let{href:a,icon:r,label:i,open:l,isSubItem:n=!1}=e,o=(0,t.usePathname)()===a;return(0,s.jsxs)(x(),{href:a,className:"group relative flex items-center gap-3 px-3 rounded-md text-sm transition-all duration-200 hover:text-[#ff6413] dark:hover:text-orange-400 ".concat(o?"text-[#ff6413] font-semibold bg-orange-50 dark:bg-gray-700":"text-gray-700 dark:text-gray-300"," ").concat(n?"py-1.5 text-xs pl-1":"py-2.5"),children:[(0,s.jsx)("span",{className:"flex-shrink-0 ".concat(n?"w-4 h-4 text-base":"w-5 h-5 text-lg"),children:r}),l?(0,s.jsx)("span",{className:"truncate",children:i}):(0,s.jsx)("span",{className:"absolute left-full ml-3 top-1/2 -translate-y-1/2 whitespace-nowrap rounded-md bg-gray-800 dark:bg-black px-2.5 py-1.5 text-xs text-white opacity-0 group-hover:opacity-100 transition-opacity z-50 shadow-lg",children:i})]})}function er(e){let{children:a}=e,{userData:r,loading:i}=(0,d.A)(),[m,h]=(0,n.useState)(!0),[U,B]=(0,n.useState)(null),K=(0,t.useRouter)(),Z=(0,t.usePathname)();(0,n.useEffect)(()=>{let e=localStorage.getItem("sidebarOpen");null!==e&&h("true"===e)},[]),(0,n.useEffect)(()=>{localStorage.setItem("sidebarOpen",m),m||B(null)},[m]),(0,n.useEffect)(()=>{i||r||K.push("/login")},[i,r,K]);let F=async()=>{await (0,o.CI)(c.j),K.push("/login")},ea=e=>!!(null==r?void 0:r.rol)&&(Array.isArray(r.rol)?e.some(e=>r.rol.includes(e)):e.includes(r.rol)),er=[{id:"general",label:"Principal",icon:(0,s.jsx)(f.A,{size:20}),roles:["Gestor","Gerencia","Almac\xe9n","TI","Supervisor","RRHH","Seguridad"],subItems:[{href:"/dashboard",label:"Dashboard",icon:(0,s.jsx)(b.A,{size:16}),roles:["Gestor","Gerencia","Almac\xe9n","TI","Supervisor","RRHH","Seguridad"]},{href:"/cuadrillas",label:"Cuadrillas",icon:(0,s.jsx)(g.A,{size:16}),roles:["Gestor","Gerencia","Almac\xe9n","TI"]},{href:"/tecnicos",label:"T\xe9cnicos",icon:(0,s.jsx)(p.A,{size:16}),roles:["Gestor","Gerencia","Almac\xe9n","TI"]}]},{id:"instalaciones",label:"Instalaciones",icon:(0,s.jsx)(j.A,{size:20}),roles:["Gestor","Gerencia","Almac\xe9n","TI"],subItems:[{href:"/instalaciones/mapa",label:"Mapa Instalaciones",icon:(0,s.jsx)(y.A,{size:16}),roles:["Gestor","Gerencia","Almac\xe9n","TI"]},{href:"/instalaciones/gerencia",label:"Vista Gerencia",icon:(0,s.jsx)(v.A,{size:16}),roles:["Gerencia","Almac\xe9n","TI"]},{href:"/instalaciones/gestor",label:"Llamadas INCONCERT",icon:(0,s.jsx)(k.A,{size:16}),roles:["Gestor"]}]},{id:"asistencia",label:"Asistencia",icon:(0,s.jsx)(A.A,{size:20}),roles:["RRHH","Seguridad","Supervisor","Gestor","Gerencia","Almac\xe9n","TI"],subItems:[{href:"/asistencia/visualizar",label:"Visualizar Asistencia",icon:(0,s.jsx)(I.A,{size:16}),roles:["RRHH","Seguridad","Supervisor","Gestor","Gerencia","Almac\xe9n","TI"]},{href:"/asistencia/registrar",label:"Registrar Asistencia",icon:(0,s.jsx)(w.A,{size:16}),roles:["Gerencia","Almac\xe9n","TI","RRHH","Seguridad","Supervisor"]}]},{id:"liquidacion",label:"Liquidaci\xf3n",icon:(0,s.jsx)(N.A,{size:20}),roles:["Almac\xe9n","TI","Gerencia"],subItems:[{href:"/liquidacion/liquidacion-almacen",label:"Liquidaci\xf3n Almac\xe9n",icon:(0,s.jsx)(z.A,{size:16}),roles:["Almac\xe9n","TI"]},{href:"/liquidacion/liquidacion",label:"Instalaciones Liquidadas",icon:(0,s.jsx)(G.A,{size:16}),roles:["Almac\xe9n","TI","Gerencia"]}]},{id:"almacen",label:"Almac\xe9n",icon:(0,s.jsx)(T.A,{size:20}),roles:["Almac\xe9n","Gerencia","TI"],subItems:[{href:"/almacen/stock",label:"Stock General Equipos",icon:(0,s.jsx)(S.A,{size:16}),roles:["Almac\xe9n","TI","Gerencia"]},{href:"/almacen/carga-equipos",label:"Ingreso Equipos",icon:(0,s.jsx)(E.A,{size:16}),roles:["Almac\xe9n","TI"]},{href:"/almacen/despacho",label:"Despacho Equipos",icon:(0,s.jsx)(C.A,{size:16}),roles:["Almac\xe9n","TI"]},{href:"/almacen/ingreso-materiales-venta",label:"Ingreso Materiales",icon:(0,s.jsx)(T.A,{size:16}),roles:["Almac\xe9n","Gerencia","TI"]},{href:"/almacen/venta-materiales",label:"Venta/Despacho Materiales",icon:(0,s.jsx)(q.A,{size:16}),roles:["Almac\xe9n","Gerencia","TI"]},{href:"/almacen/equipos",label:"Inventario Equipos",icon:(0,s.jsx)(S.A,{size:16}),roles:["Almac\xe9n","TI"]},{href:"/almacen/devolucion",label:"Devoluci\xf3n Equipos",icon:(0,s.jsx)(P.A,{size:16}),roles:["Almac\xe9n","TI"]},{href:"/almacen/recepcion-actas",label:"Recepci\xf3n Actas",icon:(0,s.jsx)(H.A,{size:16}),roles:["Almac\xe9n","TI"]}]},{id:"administracion",label:"Administraci\xf3n",icon:(0,s.jsx)(R.A,{size:20}),roles:["Gerencia","TI","Gestor"],subItems:[{href:"/admin/usuarios/usuarios",label:"Gesti\xf3n Usuarios",icon:(0,s.jsx)(D.A,{size:16}),roles:["Gerencia","TI"]},{href:"/admin/usuarios/nuevo",label:"Nuevo Usuario",icon:(0,s.jsx)(_.A,{size:16}),roles:["Gerencia","TI"]},{href:"/admin/importar-instalaciones",label:"Importar Instalaciones",icon:(0,s.jsx)(M.A,{size:16}),roles:["Gerencia","TI","Gestor"]},{href:"/gerencia/orden_compra",label:"\xd3rden de Compra",icon:(0,s.jsx)(L.A,{size:16}),roles:["Gerencia","TI"]}]},{id:"herramientas_ti",label:"Herramientas TI",icon:(0,s.jsx)(f.A,{size:20}),roles:["TI"],subItems:[{href:"/admin/exportar-sheets",label:"Exportar Liquid. a Sheets",icon:(0,s.jsx)(O.A,{size:16}),roles:["TI"]}]},{id:"configuracion",label:"Configuraci\xf3n",icon:(0,s.jsx)(V.A,{size:20}),roles:["TI"],subItems:[{href:"/configuraciones",label:"Ajustes Generales",icon:(0,s.jsx)(Q.A,{size:16}),roles:["TI"]}]}];(0,n.useEffect)(()=>{let e=er.find(e=>e.subItems&&e.subItems.some(e=>e.href===Z));e&&B(e.id)},[Z]);let es=er.map(e=>({...e,subItems:e.subItems.filter(e=>ea(e.roles))})).filter(e=>ea(e.roles)&&e.subItems.length>0);return i||!r?(0,s.jsxs)("div",{className:"jsx-951ed66fd32a1aa7 h-screen flex items-center justify-center bg-gray-100 dark:bg-black",children:[(0,s.jsxs)("div",{className:"jsx-951ed66fd32a1aa7 flex flex-col items-center",children:[(0,s.jsx)("div",{className:"jsx-951ed66fd32a1aa7 loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12 mb-4"}),(0,s.jsx)("p",{className:"jsx-951ed66fd32a1aa7 text-gray-500 dark:text-gray-400",children:"Cargando aplicaci\xf3n..."})]}),(0,s.jsx)(l(),{id:"951ed66fd32a1aa7",children:".loader.jsx-951ed66fd32a1aa7{border-top-color:#ff6413;-webkit-animation:spinner 1.2s linear infinite;-moz-animation:spinner 1.2s linear infinite;-o-animation:spinner 1.2s linear infinite;animation:spinner 1.2s linear infinite}@-webkit-keyframes spinner{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spinner{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spinner{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]}):(0,s.jsxs)("div",{className:"jsx-d03d657ec01799f7 h-screen overflow-hidden flex flex-col bg-gray-100 dark:bg-black text-gray-900 dark:text-white",children:[(0,s.jsxs)("header",{style:{height:"var(--header-height, 65px)"},className:"jsx-d03d657ec01799f7 sticky top-0 flex items-center justify-between px-4 sm:px-6 py-3 bg-white dark:bg-gray-800 border-b dark:border-gray-700 shadow-sm z-50",children:[(0,s.jsxs)("div",{className:"jsx-d03d657ec01799f7 flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:()=>h(!m),className:"jsx-d03d657ec01799f7 p-1.5 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700",children:m?(0,s.jsx)(Y.A,{className:"w-5 h-5"}):(0,s.jsx)(J.A,{className:"w-5 h-5"})}),(0,s.jsx)(x(),{href:"/dashboard",className:"flex-shrink-0",children:(0,s.jsx)(u.default,{src:"/image/logo.png",alt:"Logo de la Empresa",width:70,height:35,className:"object-contain",priority:!0})})]}),r&&(0,s.jsxs)("div",{className:"jsx-d03d657ec01799f7 flex items-center gap-3 sm:gap-4",children:[(0,s.jsx)(X,{}),(0,s.jsx)($,{}),(0,s.jsxs)("div",{className:"jsx-d03d657ec01799f7 text-right",children:[(0,s.jsx)("p",{className:"jsx-d03d657ec01799f7 text-sm font-semibold truncate max-w-[150px] sm:max-w-xs",children:r.nombres||"Usuario"}),(0,s.jsx)("p",{className:"jsx-d03d657ec01799f7 text-xs text-gray-500 dark:text-gray-400 truncate max-w-[150px] sm:max-w-xs",children:Array.isArray(r.rol)?r.rol.join(", "):r.rol||"Sin rol"}),(0,s.jsx)("button",{onClick:F,className:"jsx-d03d657ec01799f7 text-xs text-red-500 hover:text-red-700 dark:hover:text-red-400 mt-0.5",children:"Cerrar sesi\xf3n"})]})]})]}),(0,s.jsxs)("div",{className:"jsx-d03d657ec01799f7 flex flex-1 overflow-hidden",children:[(0,s.jsx)("aside",{className:"jsx-d03d657ec01799f7 "+"sticky top-0 bg-white dark:bg-gray-800 border-r dark:border-gray-700 shadow-lg transition-all duration-300 ease-in-out flex flex-col ".concat(m?"w-64":"w-20"," max-h-[calc(100vh-var(--header-height,65px))]"),children:(0,s.jsx)("nav",{className:"jsx-d03d657ec01799f7 "+"flex-grow flex flex-col gap-1 p-3 ".concat(m?"overflow-y-auto custom-scrollbar":"overflow-hidden items-center"),children:es.map(e=>(0,s.jsx)(ee,{item:e,open:m,currentPathname:Z,activeGroup:U,setActiveGroup:B},e.id))})}),(0,s.jsx)(W.P.main,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.2},className:"flex-1 h-[calc(100vh-var(--header-height,65px))] overflow-auto bg-gray-100 dark:bg-black p-4 sm:p-6",children:a},Z)]}),(0,s.jsx)(l(),{id:"d03d657ec01799f7",children:":root{--header-height:65px}.custom-scrollbar::-webkit-scrollbar{width:6px}.custom-scrollbar::-webkit-scrollbar-track{background:transparent}.custom-scrollbar::-webkit-scrollbar-thumb{background:#ccc;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px}.custom-scrollbar::-webkit-scrollbar-thumb:hover{background:#aaa}.custom-scrollbar{scrollbar-width:thin;scrollbar-color:#ccc transparent}"})]})}function es(e){let{children:a}=e,{userData:r,loading:i}=(0,d.A)(),l=(0,t.useRouter)(),o=(0,t.usePathname)(),c=["/login"].some(e=>o.startsWith(e)),[m,x]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{i||(r||c?x(!0):l.push("/login"))},[i,r,c,l]),i||!m)?(0,s.jsx)("div",{className:"h-screen flex items-center justify-center",children:(0,s.jsx)("p",{className:"text-gray-500",children:"Cargando..."})}):a}function et(e){let{children:a}=e,r=(0,t.usePathname)();return["/login"].some(e=>r.startsWith(e))?(0,s.jsx)(es,{children:a}):(0,s.jsx)(es,{children:(0,s.jsx)(er,{children:a})})}},82352:(e,a,r)=>{"use strict";let s;r.d(a,{db:()=>c,j:()=>o});var t=r(53185),i=r(34029),l=r(41519),n=r(54191);s=(0,t.Dk)().length?(0,t.Sx)():(0,t.Wp)({apiKey:"AIzaSyCmeWb5IZfDKhvqmcJYGdMQPERRli03IrE",authDomain:"redesmyd-f8616.firebaseapp.com",projectId:"redesmyd-f8616",storageBucket:"redesmyd-f8616.firebasestorage.app",messagingSenderId:"903272640767",appId:"1:903272640767:web:ff802e576eca05765a5cca",measurementId:"G-VQTNSEJHCQ"});let o=(0,i.xI)(s),c=(0,l.aU)(s);(0,n.c7)(s)}},e=>{var a=a=>e(e.s=a);e.O(0,[690,356,5,315,63,241,686,441,684,358],()=>a(34423)),_N_E=e.O()}]);